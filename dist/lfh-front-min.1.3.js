!function(e,t,n){"use strict";L.AwesomeMarkers={},L.AwesomeMarkers.version="2.0.1",L.AwesomeMarkers.Icon=L.Icon.extend({options:{iconSize:[35,45],iconAnchor:[17,42],popupAnchor:[1,-32],shadowAnchor:[10,12],shadowSize:[36,16],className:"awesome-marker",prefix:"glyphicon",spinClass:"fa-spin",extraClasses:"",icon:"home",markerColor:"blue",iconColor:"white"},initialize:function(e){e=L.Util.setOptions(this,e)},createIcon:function(){var e=t.createElement("div"),n=this.options;return n.icon&&(e.innerHTML=this._createInner()),n.bgPos&&(e.style.backgroundPosition=-n.bgPos.x+"px "+-n.bgPos.y+"px"),this._setIconStyles(e,"icon-"+n.markerColor),e},_createInner:function(){var e,t="",n="",i="",o=this.options;return e=o.icon.slice(0,o.prefix.length+1)===o.prefix+"-"?o.icon:o.prefix+"-"+o.icon,o.spin&&"string"==typeof o.spinClass&&(t=o.spinClass),o.iconColor&&("white"===o.iconColor||"black"===o.iconColor?n="icon-"+o.iconColor:i="style='color: "+o.iconColor+"' "),"<i "+i+"class='"+o.extraClasses+" "+o.prefix+" "+e+" "+t+" "+n+"'></i>"},_setIconStyles:function(e,t){var n,i=this.options,o=L.point(i["shadow"===t?"shadowSize":"iconSize"]);n="shadow"===t?L.point(i.shadowAnchor||i.iconAnchor):L.point(i.iconAnchor),!n&&o&&(n=o.divideBy(2,!0)),e.className="awesome-marker-"+t+" "+i.className,n&&(e.style.marginLeft=-n.x+"px",e.style.marginTop=-n.y+"px"),o&&(e.style.width=o.x+"px",e.style.height=o.y+"px")},createShadow:function(){var e=t.createElement("div");return this._setIconStyles(e,"shadow"),e}}),L.AwesomeMarkers.icon=function(e){return new L.AwesomeMarkers.Icon(e)}}(0,document);var L=L||require("leaflet"),_MAX_POINT_INTERVAL_MS=15e3,_SECOND_IN_MILLIS=1e3,_MINUTE_IN_MILLIS=60*_SECOND_IN_MILLIS,_HOUR_IN_MILLIS=60*_MINUTE_IN_MILLIS,_DAY_IN_MILLIS=24*_HOUR_IN_MILLIS,_DEFAULT_MARKER_OPTS={startIconUrl:"pin-icon-start.png",endIconUrl:"pin-icon-end.png",shadowUrl:"pin-shadow.png",wptIconUrls:{"":"pin-icon-wpt.png"},iconSize:[33,50],shadowSize:[50,50],iconAnchor:[16,45],shadowAnchor:[16,47],clickable:!1},_DEFAULT_POLYLINE_OPTS={color:"blue"},_DEFAULT_GPX_OPTS={parseElements:["track","route","waypoint"]};L.GPX=L.FeatureGroup.extend({initialize:function(e,t){t.max_point_interval=t.max_point_interval||_MAX_POINT_INTERVAL_MS,t.marker_options=this._merge_objs(_DEFAULT_MARKER_OPTS,t.marker_options||{}),t.polyline_options=this._merge_objs(_DEFAULT_POLYLINE_OPTS,t.polyline_options||{}),t.gpx_options=this._merge_objs(_DEFAULT_GPX_OPTS,t.gpx_options||{}),L.Util.setOptions(this,t),L.GPXTrackIcon=L.Icon.extend({options:t.marker_options}),this._gpx=e,this._layers={},this._info={name:null,length:0,elevation:{gain:0,loss:0,max:0,min:1/0,_points:[]},hr:{avg:0,_total:0,_points:[]},duration:{start:null,end:null,moving:0,total:0}},e&&this._parse(e,t,this.options.async)},get_duration_string:function(e,t){var n="";e>=_DAY_IN_MILLIS&&(n+=Math.floor(e/_DAY_IN_MILLIS)+"d ",e%=_DAY_IN_MILLIS),e>=_HOUR_IN_MILLIS&&(n+=Math.floor(e/_HOUR_IN_MILLIS)+":",e%=_HOUR_IN_MILLIS);var i=Math.floor(e/_MINUTE_IN_MILLIS);e%=_MINUTE_IN_MILLIS,i<10&&(n+="0"),n+=i+"'";var o=Math.floor(e/_SECOND_IN_MILLIS);return e%=_SECOND_IN_MILLIS,o<10&&(n+="0"),n+=o,n+=!t&&e>0?"."+Math.round(1e3*Math.floor(e))/1e3:'"'},to_miles:function(e){return e/1.60934},to_ft:function(e){return 3.28084*e},m_to_km:function(e){return e/1e3},m_to_mi:function(e){return e/1609.34},get_name:function(){return this._info.name},get_desc:function(){return this._info.desc},get_author:function(){return this._info.author},get_copyright:function(){return this._info.copyright},get_distance:function(){return this._info.length},get_distance_imp:function(){return this.to_miles(this.m_to_km(this.get_distance()))},get_start_time:function(){return this._info.duration.start},get_end_time:function(){return this._info.duration.end},get_moving_time:function(){return this._info.duration.moving},get_total_time:function(){return this._info.duration.total},get_moving_pace:function(){return this.get_moving_time()/this.m_to_km(this.get_distance())},get_moving_pace_imp:function(){return this.get_moving_time()/this.get_distance_imp()},get_moving_speed:function(){return this.m_to_km(this.get_distance())/(this.get_moving_time()/36e5)},get_moving_speed_imp:function(){return this.to_miles(this.m_to_km(this.get_distance()))/(this.get_moving_time()/36e5)},get_total_speed:function(){return this.m_to_km(this.get_distance())/(this.get_total_time()/36e5)},get_total_speed_imp:function(){return this.to_miles(this.m_to_km(this.get_distance()))/(this.get_total_time()/36e5)},get_elevation_gain:function(){return this._info.elevation.gain},get_elevation_loss:function(){return this._info.elevation.loss},get_elevation_gain_imp:function(){return this.to_ft(this.get_elevation_gain())},get_elevation_loss_imp:function(){return this.to_ft(this.get_elevation_loss())},get_elevation_data:function(){var e=this;return this._info.elevation._points.map(function(t){return e._prepare_data_point(t,e.m_to_km,null,function(e,t){return null==e||null==t?null:e.toFixed(2)+" km, "+t.toFixed(0)+" m"})})},get_elevation_data_imp:function(){var e=this;return this._info.elevation._points.map(function(t){return e._prepare_data_point(t,e.m_to_mi,e.to_ft,function(e,t){return e.toFixed(2)+" mi, "+t.toFixed(0)+" ft"})})},get_elevation_max:function(){return this._info.elevation.max},get_elevation_min:function(){return this._info.elevation.min},get_elevation_max_imp:function(){return this.to_ft(this.get_elevation_max())},get_elevation_min_imp:function(){return this.to_ft(this.get_elevation_min())},get_average_hr:function(){return this._info.hr.avg},get_heartrate_data:function(){var e=this;return this._info.hr._points.map(function(t){return e._prepare_data_point(t,e.m_to_km,null,function(e,t){return e.toFixed(2)+" km, "+t.toFixed(0)+" bpm"})})},get_heartrate_data_imp:function(){var e=this;return this._info.hr._points.map(function(t){return e._prepare_data_point(t,e.m_to_mi,null,function(e,t){return e.toFixed(2)+" mi, "+t.toFixed(0)+" bpm"})})},get_options:function(){return this.getLayers()[0].getLayers()[0].options},reload:function(){this.clearLayers(),this._parse(this._gpx,this.options,this.options.async)},get_markers:function(){return this._markers},_merge_objs:function(e,t){var n={};for(var i in e)n[i]=e[i];for(var i in t)n[i]=t[i];return n},_prepare_data_point:function(e,t,n,i){var o=[t&&t(e[0])||e[0],n&&n(e[1])||e[1]];return o.push(i&&i(o[0],o[1])||o[0]+": "+o[1]),o},_load_xml:function(e,t,n,i){void 0==i&&(i=this.options.async),void 0==n&&(n=this.options);var o=new window.XMLHttpRequest;o.open("GET",e,i);try{o.overrideMimeType("text/xml")}catch(e){}var r=this;o.onreadystatechange=function(){4==o.readyState&&(200==o.status?t(o.responseXML,n):r.options.isLoaded=!0)},o.send(null)},_parse:function(e,t,n){var i=this,o=function(e,t){var n=i._parse_gpx_data(e,t);if(!n)return void(i.options.isLoaded=!0);i.addLayer(n),i.fire("loaded")};if("<"===e.substr(0,1)){var r=new DOMParser;n?setTimeout(function(){o(r.parseFromString(e,"text/xml"),t)}):o(r.parseFromString(e,"text/xml"),t)}else this._load_xml(e,o,t,n)},_markers:[],_parse_gpx_data:function(e,t){var n,i,o,r=[],a=[],l=t.gpx_options.parseElements;l.indexOf("route")>-1&&a.push(["rte","rtept"]),l.indexOf("track")>-1&&a.push(["trkseg","trkpt"]);var s=e.getElementsByTagName("name");s.length>0&&(this._info.name=s[0].textContent);var c=e.getElementsByTagName("desc");c.length>0&&(this._info.desc=c[0].textContent);var h=e.getElementsByTagName("author");h.length>0&&(this._info.author=h[0].textContent);var u=e.getElementsByTagName("copyright");for(u.length>0&&(this._info.copyright=u[0].textContent),n=0;n<a.length;n++)for(o=e.getElementsByTagName(a[n][0]),i=0;i<o.length;i++){var f=this._parse_trkseg(o[i],e,t,a[n][1]);if(0!==f.length){var d=new L.Polyline(f,t.polyline_options);if(this.fire("addline",{line:d}),r.push(d),t.marker_options.startIcon||t.marker_options.startIconUrl){var _=new L.Marker(f[0],{clickable:t.marker_options.clickable,icon:t.marker_options.startIcon||new L.GPXTrackIcon({iconUrl:t.marker_options.startIconUrl})});this._markers.push(_),this.fire("addpoint",{point:_,point_type:"start"}),r.push(_)}(t.marker_options.endIcon||t.marker_options.endIconUrl)&&(_=new L.Marker(f[f.length-1],{clickable:t.marker_options.clickable,icon:t.marker_options.endIcon||new L.GPXTrackIcon({iconUrl:t.marker_options.endIconUrl})}),this._markers.push(_),this.fire("addpoint",{point:_,point_type:"end"}),r.push(_))}}if(this._info.hr.avg=Math.round(this._info.hr._total/this._info.hr._points.length),l.indexOf("waypoint")>-1)for(o=e.getElementsByTagName("wpt"),i=0;i<o.length;i++){var m=new L.LatLng(o[i].getAttribute("lat"),o[i].getAttribute("lon")),p=o[i].getElementsByTagName("name"),s="";p.length>0&&(s=p[0].textContent);var g=o[i].getElementsByTagName("desc"),c="";g.length>0&&(c=g[0].textContent);var v=o[i].getElementsByTagName("sym"),y="";v.length>0&&(y=v[0].textContent);var x;if(t.marker_options.wptIcons&&t.marker_options.wptIcons[y])x=t.marker_options.wptIcons[y];else{if(!t.marker_options.wptIconUrls||!t.marker_options.wptIconUrls[y]){console.log('No icon or icon URL configured for symbol type "'+y+'"; ignoring waypoint.');continue}x=new L.GPXTrackIcon({iconUrl:t.marker_options.wptIconUrls[y]})}var I=new L.Marker(m,{clickable:!0,title:s,icon:x});I.bindPopup("<b>"+s+"</b>"+(c.length>0?"<br>"+c:"")).openPopup(),this.fire("addpoint",{point:I,point_type:"waypoint"}),r.push(I)}return r.length>1?new L.FeatureGroup(r):1==r.length?r[0]:void 0},_parse_trkseg:function(e,t,n,i){var o=e.getElementsByTagName(i);if(!o.length)return[];for(var r=[],a=null,l=0;l<o.length;l++){var s,c=new L.LatLng(o[l].getAttribute("lat"),o[l].getAttribute("lon"));if(c.meta={time:null,ele:null,hr:null},s=o[l].getElementsByTagName("time"),s.length>0&&(c.meta.time=new Date(Date.parse(s[0].textContent))),s=o[l].getElementsByTagName("ele"),s.length>0&&(c.meta.ele=parseFloat(s[0].textContent)),s=o[l].getElementsByTagNameNS("*","hr"),s.length>0&&(c.meta.hr=parseInt(s[0].textContent),this._info.hr._points.push([this._info.length,c.meta.hr]),this._info.hr._total+=c.meta.hr),c.meta.ele>this._info.elevation.max&&(this._info.elevation.max=c.meta.ele),c.meta.ele<this._info.elevation.min&&(this._info.elevation.min=c.meta.ele),this._info.elevation._points.push([this._info.length,c.meta.ele]),this._info.duration.end=c.meta.time,null!=a){this._info.length+=this._dist3d(a,c);var h=c.meta.ele-a.meta.ele;h>0?this._info.elevation.gain+=h:this._info.elevation.loss+=Math.abs(h),h=Math.abs(c.meta.time-a.meta.time),this._info.duration.total+=h,h<n.max_point_interval&&(this._info.duration.moving+=h)}else this._info.duration.start=c.meta.time;a=c,r.push(c)}return r},_dist2d:function(e,t){var n=this._deg2rad(t.lat-e.lat),i=this._deg2rad(t.lng-e.lng),o=Math.sin(n/2)*Math.sin(n/2)+Math.cos(this._deg2rad(e.lat))*Math.cos(this._deg2rad(t.lat))*Math.sin(i/2)*Math.sin(i/2);return 2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))*6371e3},_dist3d:function(e,t){var n=this._dist2d(e,t),i=Math.abs(t.meta.ele-e.meta.ele);return Math.sqrt(Math.pow(n,2)+Math.pow(i,2))},_deg2rad:function(e){return e*Math.PI/180}}),"object"==typeof module&&"object"==typeof module.exports?module.exports=L:"function"==typeof define&&define.amd&&define(L),function(){String.prototype.addslashes=function(){return this.replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")},String.prototype.stripslashes=function(){return this.replace(/\\(.?)/g,function(e,t){switch(t){case"\\":return"\\";case"0":return"\0";case"":return"";default:return t}})},String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"g"),t)},void 0===lfh.Util&&(lfh.Util={}),lfh.Util.step_round=function(e){var t=Math.round(Math.log(e)/Math.log(10)),n=Math.pow(10,t),i=Math.ceil(e/n)*n;return i/2>e?i/2:i},lfh.ZOOM_LIMIT=11,lfh.ICON_MOVE=L.icon({iconUrl:lfh.ICON_URL+"/markers/move.png",iconSize:[15,15],shadowSize:[0,0],iconAnchor:[7,7],shadowAnchor:[7,7],popupAnchor:[7,7]}),lfh.POINT_ICON=L.icon({iconUrl:lfh.ICON_URL+"/markers/pointS000063.png",iconSize:[10,10],shadowSize:[0,0],iconAnchor:[5,5],shadowAnchor:[5,5],popupAnchor:[5,5]}),lfh.WIDTH_LIMIT=620,lfh.HEIGHT=170,lfh.WIDTH=280,lfh.initialize_map=function(e){"function"!=typeof lfh.data[e]&&(lfh.all[e]=new lfh.Map(e))},lfh.all=new Array,lfh.initialize=function(e){if(e<lfh.data.length){lfh.initialize_map(e);var t=function(){lfh.initialize(e+1)};setTimeout(t,0)}},lfh.ResetControl=L.Control.extend({options:{position:"topleft"},_center:null,_zoom:13,initialize:function(e,t){this._center=e,this._zoom=t},onAdd:function(e){var t=L.DomUtil.create("div","leaflet-bar leaflet-control lfh-control-refresh"),n=this._center,i=this._zoom;return t.onclick=function(){e.setView(n,i)},t}}),lfh.TopControl=L.Control.extend({options:{position:"topright"},_fullscreen:!0,_list:!0,_selected:null,initialize:function(e,t){this._fullscreen=e.fullscreen,this._list=e.list,this._index=e.i,this._selected=t},onAdd:function(e){var t=L.DomUtil.create("div","lfh-container-fullscreen");if(this._fullscreen){var n=L.DomUtil.create("div","leaflet-bar leaflet-control lfh-control-fullscreen");t.appendChild(n),n.onclick=function(){var t=e._container.id,n=L.DomUtil.get("lfh-fade"),i=L.DomUtil.get(t+"-fadable");this.className.indexOf("actived")>=0?(L.DomUtil.get(t+"-skin").appendChild(i),this.className=this.className.replace(" actived",""),n.className=n.className.replace(" actived",""),e._container.style.height=e._container.h0,e.options.mousewheel||e.scrollWheelZoom.disable()):(n.appendChild(i),this.className+=" actived",n.className=n.className+" actived",e.scrollWheelZoom.enable(),e._container.h0=e._container.style.height,e._container.style.height="100%"),lfh.resize_all_map()}}if(this._list){var i=L.DomUtil.create("div","leaflet-bar leaflet-control lfh-control-list");t.appendChild(i);new lfh.Link(e,i,"lfh-list-"+this._index,this._selected,null,null,null)}return t}}),lfh.resize_content=function(e){var t=document.querySelector("#"+e.id+"-data"),n=t.offsetHeight;if(!(e.parentNode.parentNode.className.indexOf("lfh-min")<0)){n=220;var i=t.querySelectorAll(".lfh-section.hidden");return void[].forEach.call(i,function(e){var t=e.className;t.indexOf("disabled")>=0||t.indexOf("hidden")>=0&&(e.className=t.replaceAll(" hidden",""))})}n-=70;for(var o=t.getElementsByClassName("lfh-element"),r=0;r<o.length;r++)o.item(r).style.maxHeight=n+"px",o.item(r).querySelector(".lfh-element-content").style.maxHeight=n-40+"px"},lfh.map_resize=function(e){var t=e.getContainer().offsetWidth,n=e.getContainer().parentNode.parentNode;if(t<=lfh.WIDTH_LIMIT)n.className+=" lfh-min",_large=!1;else if(t>lfh.WIDTH_LIMIT){var i=n.className;n.className=i.replaceAll(" lfh-min",""),_large=!0}if("lfh-fade"==e.getContainer().parentNode.parentNode.id)if(_large)e.getContainer().style.height="100%";else{var o=document.querySelector(".lfh-nav");e.getContainer().style.height=n.offsetHeight-o.offsetHeight+2+"px"}e.invalidateSize()},lfh.resize_all_map=function(){[].forEach.call(lfh.all,function(e){lfh.map_resize(e)})},L.DomEvent.addListener(window,"resize",function(e){lfh.resize_all_map()}),lfh.Selected=function(e,t,n){this.map_id=e;var i=n,t=t;this.id=null,this.ayer=null,this.dom=null,this.title=document.querySelector("#"+e+"-data div.lfh-nav .lfh-trackname").textContent,this.close=function(){if(document.querySelector("#"+this.map_id+"-nav .lfh-next").style.display="none",null!=this.id){var e=this.dom.className;if(this.dom.className=e+" hidden",this.layer instanceof L.GPX){var n=this.layer.get_options();this.layer.setStyle({color:n.realColor}),t.removeLayer(i)}}},this.set=function(e){for(var t in e)this[t]=e[t]},this.toggle_next=function(e){if(null!==this.dom&&null!==this.layer){var t=this.dom.step,n=t+e;this.dom.step=n,this.dom.className=this.dom.className.replace("step"+t,"step"+n),this.dom.step_max<=this.dom.step+1?document.querySelector("#"+this.map_id+"-nav .lfh-next").style.display="none":document.querySelector("#"+this.map_id+"-nav .lfh-next").style.display="block"}}},lfh.Map=function(t){function n(e){"mapquest"==e?MQ.mapLayer().addTo(p):L.tileLayer(lfh.tiles[e].url,{attribution:lfh.tiles[e].attribution,minZoom:1,maxZoom:lfh.tiles[e].max_zoom}).addTo(p)}function i(e){p.addControl(new lfh.TopControl(e,T)),!k&&e.reset&&p.addControl(new lfh.ResetControl(x,I))}function o(){M=L.layerGroup(),I>=N&&M.addTo(p);for(var e in y.markers)"function"!=typeof y.markers[e]&&c(e)}function r(){for(var e in y.gpx)"function"!=typeof y.gpx[t]&&m(e)}function a(){p.on("zoomend",function(){p.getZoom()<N?this.hasLayer(M)&&this.removeLayer(M):this.hasLayer(M)||M.addTo(this)}),p.on("resize",function(){if(T.id&&T.id.indexOf("lfh-list")>=0){var e=T.layer,t=document.createEvent("MouseEvents");t.initEvent("click",!0,!0),e.dispatchEvent(t)}lfh.map_resize(this),lfh.resize_content(this.getContainer())})}function l(){var e=document.querySelector("#"+g+"-nav .lfh-close");L.DomEvent.addListener(e,"click",function(e){T.layer.fire("click")});var t=document.querySelector("#"+g+"-nav .lfh-back");L.DomEvent.addListener(t,"click",function(e){T.toggle_next(-1)});var n=document.querySelector("#"+g+"-nav .lfh-next");L.DomEvent.addListener(n,"click",function(e){T.toggle_next(1)})}function s(e){C=L.marker(e,{icon:lfh.ICON_MOVE})}function c(e){var t=y.markers[e],n="marker-"+v+"-"+e,i=L.marker([t.lat,t.lng],{elem_id:n,icon:L.AwesomeMarkers.icon({icon:t.icon,prefix:"fa",markerColor:t.color}),title:t.title.stripslashes(),visibility:"zoom"});return t.popup=t.popup+"",t.popup.length>0&&i.bindPopup(t.popup.stripslashes()),"zoom"==t.visibility?M.addLayer(i):i.addTo(p),E.push([t.lat,t.lng]),h(i),new lfh.Link(p,i,n,T,null)}function h(e){(u(e,document.querySelector("#"+g+"-data .lfh-data-content .lfh-content")),S)&&u(e,document.querySelector("#lfh-list-"+v+" div.lfh-list-markers"))}function u(e,t){var n=document.createElement("input");n.setAttribute("type","button"),n.value=e.options.title,n.className="lfh-button",t.appendChild(n),L.DomEvent.addListener(n,"click",function(t){e.fire("click"),t.stopPropagation()})}function f(e){(d(e,document.querySelector("#"+g+"-data .lfh-data-content .lfh-content")),S)&&d(e,document.querySelector("#lfh-list-"+v+" div.lfh-list-gpx"))}function d(e,t){var n=document.createElement("input");n.setAttribute("type","button"),n.className="lfh-button",n.value=document.querySelector("#"+e.options.elem_id+" span.lfh-trackname").textContent,t.insertBefore(n,t.firstChild),L.DomEvent.addListener(n,"click",function(t){e.fire("click"),t.stopPropagation()})}function _(e){var t=1;for(var n in y.gpx)"function"!=typeof y.gpx[n]&&(t*=void 0!==w[n]&&w[n].options.isLoaded);t?(E.length>0&&p.fitBounds(E),x=p.getCenter(),I=p.getZoom(),lfh.tiles[y.map.tile].max_zoom<I&&(I=lfh.tiles[y.map.tile].max_zoom,p.setZoom(I)),e&&p.addControl(new lfh.ResetControl(x,I)),lfh.resize_content(p.getContainer()),k=!0):setTimeout(function(){_(e)},500)}function m(t){var n="track-"+v+"-"+t;w[t]=new L.GPX(y.gpx[t].src,{async:!0,isLoaded:!1,elem_id:n,marker_options:{startIcon:lfh.POINT_ICON,endIcon:lfh.POINT_ICON}}).on("loaded",function(e){if(e.target.options.isLoaded=!0,e.target.setStyle({color:y.gpx[t].color,weight:y.gpx[t].width}),k){var i=e.target.getBounds();E.push([i.getNorth(),i.getEast()]),E.push([i.getSouth(),i.getWest()])}f(e.target);new lfh.Link(p,e.target,n,T,C,y.gpx[t].unit,y.gpx[t].unit_h)}).on("failed",function(){e.target.options.isLoaded=!0,console.log("failed")}).addTo(p)}var p=null,g="lfh-"+t,v=t,y=lfh.data[t],x=[0,0],I=13,N=lfh.ZOOM_LIMIT,k=!0,S=!1,w=new Array,C=null,M=null,E=new Array,T=null;return function(e){y=lfh.data[e];var t=lfh.data[e].map;t.i=e,k=t.autocenter,S=t.list,x=[t.lat,t.lng],I=Math.min(t.zoom,lfh.tiles[t.tile].max_zoom),p=L.map(g).setView(x,I),n(t.tile),p.options.mousewheel=t.mousewheel,t.mousewheel||p.scrollWheelZoom.disable(),s(x),T=new lfh.Selected(g,p,C),o(),r(),a(),_(t.reset),l(),i(t),lfh.map_resize(p)}(t),p},lfh.Link=function(e,t,n,i,o,r,a){function l(e){var t=e.querySelectorAll("img");[].forEach.call(t,function(e){e.parentNode.className.indexOf("wp-caption")>=0&&(e.style.maxWidth=lfh.WIDTH-10+"px",e.style.maxHeight=lfh.HEIGHT-60+"px",e.setAttribute("srcset",""),e.parentNode.style.maxWidth=lfh.WIDTH+"px",e.parentNode.style.maxHeight=lfh.HEIGHT+"px",e.parentNode.style.width=lfh.WIDTH+"px",e.parentNode.style.height=lfh.HEIGHT+"px"),"p"===e.parentNode.tagName.toLowerCase()&&e.parentNode.parentNode.insertBefore(e,e.parentNode)});var n=e.querySelector(".lfh-description");if(null===n)return 0;var i=n.childNodes,o=new Array,r="scelerisque massa pretium sed. Vivamus est ".length,a=document.createElement("div"),l=0;return[].forEach.call(i,function(e){switch(e.nodeType){case Node.ELEMENT_NODE:switch(e.tagName.toLowerCase()){case"p":case"span":if(e.textContent.trim().length>0){var t=1+e.textContent.trim().length/r;l+t>17&&(o.push(a),a=document.createElement("div"),l=0),a.appendChild(e),l+=t}break;case"img":l>0&&(o.push(a),a=document.createElement("div"),l=0);var n=document.createElement("div");n.appendChild(e),o.push(n);break;case"ul":case"ol":var t=0,i=e.querySelectorAll("li");[].forEach.call(i,function(e){t+=1+e.textContent.trim().length/r}),l+t>17&&l>0&&(o.push(a),a=document.createElement("div"),l=0),a.appendChild(e),l+=t;break;case"div":l>0&&o.push(a),a=e.cloneNode(!0),o.push(a),a=document.createElement("div"),l=0}break;case Node.TEXT_NODE:if(e.nodeValue.trim().length>0){var s=document.createElement("p");s.textContent=e.nodeValue.trim();var t=1+e.nodeValue.trim().length/r;l+t>17&&(o.push(a),a=document.createElement("div"),l=0),a.appendChild(s),l+=t}}}),l>0&&o.push(a),n.innerHTML="",[].forEach.call(o,function(e){n.appendChild(e)}),o.length}function s(){if(p.close(),null==p.id||p.id!=f){if(_.className=_.className.replaceAll(" hidden",""),d instanceof L.GPX){var t=d.get_options();d.setStyle({realColor:t.color,color:lfh.SELECTED_COLOR}),g.addTo(e)}d instanceof L.Marker&&d.openPopup(),p.set({id:f,layer:d,dom:_}),c(),p.toggle_next(0)}else p.set({id:null,layer:null,dom:null}),d instanceof L.Marker&&d.closePopup(),h()}function c(){var e=document.querySelector("#"+m.getContainer().id+"-data div.lfh-nav");e.querySelector(".lfh-trackname").textContent=p.dom.querySelector(".lfh-trackname").textContent;var t=e.querySelector(".lfh-gpx-file");if(null!=t&&t.parentNode.removeChild(t),p.layer instanceof L.GPX){var t=p.dom.querySelector(".lfh-gpx-file").cloneNode(!0);e.querySelector(".lfh-title").appendChild(t)}}function h(){var e=document.querySelector("#"+m.getContainer().id+"-data div.lfh-nav");e.querySelector(".lfh-trackname").textContent=p.title;var t=e.querySelector(".lfh-gpx-file");null!=t&&t.parentNode.removeChild(t)}function u(){var e=_.querySelectorAll(".lfh-element .lfh-header");[].forEach.call(e,function(e){L.DomEvent.addListener(e,"click",function(t){t.preventDefault();var n=e.parentNode,i=n.className;i.indexOf("disabled")>=0||(i.indexOf("hidden")>=0?n.className=i.replaceAll(" hidden",""):n.className+=" hidden",t.stopPropagation())})}),L.DomEvent.addListener(_,"mousemove",function(e){e.stopPropagation()}),L.DomEvent.addListener(_,"mousewheel",function(e){e.stopPropagation(),e.preventDefault()});var t=_.querySelector(".lfh-close");d instanceof L.Layer?(d.on("click",function(e){s()}),L.DomEvent.addListener(t,"click",function(e){d.fire("click")})):(L.DomEvent.addListener(d,"click",function(e){s()}),L.DomEvent.addListener(t,"click",function(e){s()}))}var f=n,d=t,_=L.DomUtil.get(n),m=e,p=i,g=o,v=r,y=a;return function(){if(void 0===d.options&&(d.options={}),d.options.elem_id=n,null!=_){var e=document.querySelector("#"+m.getContainer().id+"-data"),t=e.querySelector(".lfh-nav");e.insertBefore(_,t),_.step=0,_.step_max=l(_),d instanceof L.GPX&&(_.step_max+=2),u(),d instanceof L.GPX&&new lfh.Profile(m,d,_,g,v,y)}}(),{dom:_,layer:d,id:f}},lfh.Profile=function(e,t,n,i,o,r){function a(e){return 220*e/(S*_)}function l(e){return 200-40*(e/m-M)/w}function s(){for(var e="M ",t=0;t<x.length;t++)e+=Math.round(a(x[t][0]))+","+Math.round(l(x[t][1])),t!=x.length-1&&(e+=" L ");return e}function c(){if(I){var e=s();v.querySelector(".lfh-profile-line").setAttribute("d",e);for(var t=1;t<5;t++)v.querySelector(".h"+t).textContent=M+t*w;for(var t=1;t<4;t++){var n=v.querySelector(".v"+t),i=Math.round(t*E*220/S);n.setAttribute("transform","translate("+i+", 0)"),n.querySelector("text").textContent=t*E}v.querySelector(".lfh-gpx-elevation-gain").textContent=Math.round(g.get_elevation_gain()/m)+" "+lfh.HEIGHT_UNIT[d].code,v.querySelector(".lfh-gpx-elevation-loss").textContent=Math.round(g.get_elevation_loss()/m)+" "+lfh.HEIGHT_UNIT[d].code;var o=g.get_total_time();o&&(v.querySelector(".lfh-gpx-duration").textContent=g.get_duration_string(o)),L.DomEvent.addListener(v.querySelector("svg"),"click mousemove",function(e){h(e)},!1),v.querySelector("svg").addEventListener("touchmove",function(e){h(e.touches[0])})}else v.querySelector("svg").parentNode.removeChild(v.querySelector("svg"));v.querySelector(".lfh-gpx-name").textContent=g.get_name(),v.querySelector(".lfh-gpx-distance").textContent=(Math.round(g.get_distance()/(100*_))/10).toString().replace(".",",")+" "+lfh.DISTANCE_UNIT[f].code}function h(e){var t=v.querySelector("svg"),n=t.getBoundingClientRect(),i=290/n.width,o=e.pageX-n.left-window.pageXOffset;o=o*i-50,o<0&&(o=0),o>220&&(o=220),v.querySelector(".lfh-move-line").setAttribute("transform","translate("+o+",0)");var r=o*S/220,n=u(r);p.setLatLng(y[n])}function u(e){for(var e=e*_,t=!1,n=0,i=x.length-1;!t&&i-n>1;){var o=Math.ceil((n+i)/2);t=x[o]==e,x[o][0]>e?i=o:n=o}return n}var f=o,d=r;if("km"==f)var _=1;else var _=1.60934;if("m"==d)var m=1;else var m=.3048;var p=i,g=t,v=n,y=g.getLayers()[0].getLayers()[0].getLatLngs(),x=g.get_elevation_data();if(null!=x[0][1])var I=!0,N=g.get_elevation_max()/m,k=g.get_elevation_min()/m,S=x[x.length-1][0]/_,w=lfh.Util.step_round((N-k)/3.5),C=Math.ceil(N/w)*w,M=C-5*w,E=lfh.Util.step_round(S/4);else var I=!1;return c(),{draw:c}},lfh.initialize(1)}();